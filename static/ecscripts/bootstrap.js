/*!
 *
 * Copyright 2016 Google Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Build: 2018-01-05T02:24:18.249Z
 */function loadScript(c,e){return new Promise(function(f,g){var l=document.createElement('script');l.src=c,'undefined'!=typeof e&&(l.async=e),l.onerror=g,l.onload=f,document.head.appendChild(l)})}function loadStyles(c){return new Promise(function(e,f){var g=new XMLHttpRequest;g.returnType='text',g.onload=function(){var l=document.createElement('link');l.rel='stylesheet',l.href=c,document.head.appendChild(l),e()},g.onerror=f,g.open('get',c),g.send()})}class Toast{static create(c,e){var f=document.querySelector('.toast-container');f||(f=document.createElement('div'),f.classList.add('toast-container'),document.body.appendChild(f)),e=e||{};var g=e.tag||Date.now().toString();Array.from(f.querySelectorAll(`.toast[data-tag="${g}"]`)).forEach(o=>{o.parentNode.removeChild(o)});var l=document.createElement('div'),m=document.createElement('div');l.classList.add('toast'),m.classList.add('toast__content'),m.textContent=c,l.appendChild(m),l.dataset.tag=g,f.appendChild(l);var n=e.timeout||3000;setTimeout(function(){l.classList.add('toast--dismissed')},n),l.addEventListener('transitionend',function(o){o.target.parentNode.removeChild(o.target)})}}var db;function getDB(){return db||(db=new Promise(function(c,e){var f=indexedDB.open('keyval-store',1);f.onerror=function(){e(f.error)},f.onupgradeneeded=function(){f.result.createObjectStore('keyval')},f.onsuccess=function(){c(f.result)}})),db}function withStore(c,e){return getDB().then(function(f){return new Promise(function(g,l){var m=f.transaction('keyval',c);m.oncomplete=function(){g()},m.onerror=function(){l(m.error)},e(m.objectStore('keyval'))})})}var idbKeyval={get:function(c){var e;return withStore('readonly',function(f){e=f.get(c)}).then(function(){return e.result})},set:function(c,e){return withStore('readwrite',function(f){f.put(e,c)})},delete:function(c){return withStore('readwrite',function(e){e.delete(c)})},clear:function(){return withStore('readwrite',function(c){c.clear()})},keys:function(){var c=[];return withStore('readonly',function(e){(e.openKeyCursor||e.openCursor).call(e).onsuccess=function(){this.result&&(c.push(this.result.key),this.result.continue())}}).then(function(){return c})}};function urlBase64ToUint8Array(c){const e='='.repeat((4-c.length%4)%4),f=(c+e).replace(/\-/g,'+').replace(/_/g,'/'),g=window.atob(f),l=new Uint8Array(g.length);for(let m=0;m<g.length;++m)l[m]=g.charCodeAt(m);return l}class SessionLoader{static getData(){return SessionLoader._sessionMap?Promise.resolve(SessionLoader._sessionMap):new Promise(function(c,e){var f=new XMLHttpRequest;f.open('get','{{ "/devsummit/static/json/sessions.json" | add_hash }}'),f.responseType='json',f.onload=function(){for(var n,o,q,u,w,g=f.response,l=Object.keys(g),m=new Map,z=0;z<l.length;z++){n=l[z],o=g[l[z]],q=Object.keys(o);for(var A=0;A<q.length;A++)u=q[A],w=SessionLoader._dateFrom(n,u),m.set(w,g[n][u])}SessionLoader._sessionMap=m,c(SessionLoader._sessionMap)},f.onerror=e,f.send()})}static toArray(c){var e=[];return c.forEach(function(f,g){e.push(g)}),e.sort(function(f,g){return f.getTime()-g.getTime()})}static _dateFrom(c,e){var f=c.split('-'),g=e.split(':'),l=new Date(Date.UTC(parseInt(f[0],10),parseInt(f[1]-1,10),parseInt(f[2],10),parseInt(g[0],10)+8,parseInt(g[1],10),parseInt(g[2],10)));return l}}class PushControls{static init(){const c=document.querySelector('#tmpl-notification-area');return c?void(this._toggleViewVisibility=this._toggleViewVisibility.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this._trapTabKey=this._trapTabKey.bind(this),this._onHashChange=this._onHashChange.bind(this),this._onTransitionEnd=this._onTransitionEnd.bind(this),this._removeHash=this._removeHash.bind(this),this._firstTabStop=null,this._lastTabStop=null,this._list=null,this._removeAllContainer=null,SessionLoader.getData().then(e=>{document.body.appendChild(c.content.cloneNode(!0)),this._element=document.querySelector('.notification-area'),this._content=this._element.querySelector('.notification-content__list'),this._toggleButton=this._element.querySelector('.notification-toggle-button'),this._panelTitle=this._element.querySelector('.notification-content__title'),this._panelHeader=this._element.querySelector('.notification-content__headline'),this._closeButton=this._element.querySelector('.notification-close-button'),this._unsubscribeAllButton=this._element.querySelector('.notification-content__remove-all'),this._populateElement(e),this._addEventListeners()}).catch(e=>{console.log(e)})):void console.log('Unable to locate notification template')}static remove(){const c=document.querySelector('.notification-area');c&&c.parentNode.removeChild(c)}static _timeAsString(c){return(10>c.getHours()?'0':'')+c.getHours().toString()+(10>c.getMinutes()?'0':'')+c.getMinutes().toString()}static _toPST(c){var e=new Date(c.getTime());return e.setTime(e.getTime()+60000*e.getTimezoneOffset()-28800000),e}static _populateElement(c){const e=[...c];e.unshift(['__NONE',{url:'event',name:'Event Updates'}]);const f=document.querySelector('#tmpl-notification-item');f&&idbKeyval.get('localized-times').then(g=>{e.forEach(m=>{const n=m[0],o=m[1];if(o.url&&!1!==o.notify){const q=f.content.cloneNode(!0),u=q.querySelector('.notification-item__details'),w=q.querySelector('.notification-item__breakdown-title'),z=q.querySelector('.notification-item__breakdown-time'),A=q.querySelector('.notification-item__breakdown-day');if(u.dataset.id=o.url,w.textContent=(o.speaker?o.speaker+': ':'')+o.name,u.dataset.title=(o.speaker?o.speaker+': ':'')+o.name,'__NONE'===n)z.parentNode.removeChild(z),A.parentNode.removeChild(A);else{z.setAttribute('datetime',n.toISOString()),A.textContent=(10===this._toPST(n).getDate()?'Day 1':'Day 2')+', ';let B=n;g||(B=this._toPST(n)),z.textContent=this._timeAsString(B)}this._content.appendChild(q)}}),this.updateListing();const l=Array.from(this._element.querySelectorAll('.notification-item__details'));1>l.length||(this._removeAllContainer=this._element.querySelector('.notification-content__remove-all-container'),this._focusableElements=Array.from(this._element.querySelectorAll('button:not(.notification-toggle-button)')),this._firstTabStop=this._focusableElements[0],this._lastTabStop=this._focusableElements[this._focusableElements.length-1],this._list=this._element.querySelector('.notification-content__list'),this._onHashChange(),this._onTransitionEnd(),requestAnimationFrame(m=>{requestAnimationFrame(n=>{this._element.classList.add('notification-area--active')})}))})}static updateListing(){const c=Array.from(this._element.querySelectorAll('.notification-item__details'));c.forEach(e=>{const f=e.dataset.id;f&&idbKeyval.get(f).then(g=>{g?(e.classList.add('notification-item__details--active'),e.setAttribute('aria-label','Disable notifications for '+e.dataset.title)):(e.classList.remove('notification-item__details--active'),e.setAttribute('aria-label','Enable notifications for '+e.dataset.title))})})}static _addEventListeners(){window.addEventListener('hashchange',this._onHashChange),this._toggleButton.addEventListener('click',this._toggleViewVisibility),this._element.addEventListener('click',this._handleClick),this._unsubscribeAllButton.addEventListener('click',c=>{PushHandler.removeSubscription()}),this._closeButton.addEventListener('click',this._removeHash),document.addEventListener('click',c=>{this._element.classList.contains('notification-area--expanded')&&this._removeHash()}),window.addEventListener('keydown',this._trapTabKey),this._element.addEventListener('transitionend',this._onTransitionEnd)}static _onHashChange(c){return c&&c.preventDefault(),'#notifications'===window.location.hash?void this.show():void this.hide()}static _onTransitionEnd(c){if(!(c&&c.target!==this._element))if(this._element.classList.contains('notification-area--expanded'))this._panelHeader.inert=!1,this._list.inert=!1,this._removeAllContainer.inert=!1,this._panelTitle.focus();else{if(this._list.inert=!0,this._panelHeader.inert=!0,this._removeAllContainer.inert=!0,!c)return;if(!c.target.classList.contains('notification-ripple'))return;this._toggleButton.focus()}}static _handleClick(c){c.stopPropagation();let e=c.target;do{if(e&&e.classList&&e.classList.contains('notification-item__details'))return void PushHandler.processChange(e);e=e.parentNode}while(e&&e!==this._element)}static _toggleViewVisibility(){this._element.classList.contains('notification-area--expanded')?this._removeHash():window.location.hash='notifications'}static _removeHash(){window.history.pushState(null,null,window.location.href.replace(/#.*$/,'')),this._onHashChange()}static show(){this._element&&requestAnimationFrame(c=>{this._element.classList.add('notification-area--expanded')})}static hide(){this._element&&this._element.classList.remove('notification-area--expanded')}static _trapTabKey(c){return this._element.hasAttribute('inert')?void 0:-1===this._focusableElements.indexOf(document.activeElement)?(c.preventDefault(),void this._firstTabStop.focus()):void(9===c.keyCode&&(c.shiftKey?document.activeElement===this._firstTabStop&&(c.preventDefault(),this._lastTabStop.focus()):document.activeElement===this._lastTabStop&&(c.preventDefault(),this._firstTabStop.focus())),27===c.keyCode&&this._removeHash())}}class PushHandler{static get REMOTE_SERVER(){return'https://cds-push.appspot.com'}static init(){return'denied'===Notification.permission?void PushHandler._shutdown():void PushHandler._shutdown()}static _shutdown(){const c=document.querySelectorAll('.notification-btn');for(let e of c)e.parentNode.removeChild(e);document.body.classList.remove('push-enabled'),PushControls.remove()}static showControls(){this._init&&this._init.then(c=>{PushControls.show()})}static hideControls(){this._init&&this._init.then(c=>{PushControls.hide()})}static updateCurrentView(){if(this._intitialized){const c=document.querySelector('.event-updates');c&&c.classList.add('event-updates--active');const e=Array.from(document.querySelectorAll('.notification-btn'));e.length&&e.forEach(f=>{const g=f.dataset.id,l=f.querySelector('.notification-btn__inner');g&&(f.disabled=!0,f.hidden=!1,idbKeyval.get(g).then(m=>{f.disabled=!1,m?(f.classList.add('notification-btn--enabled'),f.classList.remove('notification-btn--disabled')):(f.classList.remove('notification-btn--enabled'),f.classList.add('notification-btn--disabled')),l.textContent=''}))})}}static processChange(c){const e=c.target||c;if(e&&e.dataset){const f=e.dataset.id;!f||this._waiting||(PushHandler._disableButtons(`button[data-id="${f}"]`),idbKeyval.get(f).then(g=>{const l='undefined'==typeof g||!g;Toast.create('Updating subscriptions...',{tag:f}),PushHandler.updateSubscriptions([{id:f,subscribed:l}]).then(m=>{Toast.create(l?'Subscribed successfully.':'Unsubscribed successfully.',{tag:f}),PushHandler.updateCurrentView(),PushControls.updateListing(),PushHandler._enableButtons(`button[data-id="${f}"]`)}).catch(m=>{Toast.create('Unable to update notifications.',{tag:f}),this._waiting=!1,PushHandler._enableButtons(`button[data-id="${f}"]`)})}))}}static _disableButtons(c){const e=Array.from(document.querySelectorAll(c));e.forEach(f=>{f.disabled=!0})}static _enableButtons(c){const e=Array.from(document.querySelectorAll(c));e.forEach(f=>{f.disabled=!1})}static removeSubscription(){if(!this._waiting)return this._waiting=!0,PushHandler._disableButtons('button[data-id]'),Toast.create('Unsubscribing...',{tag:'all'}),'function'==typeof window.ga&&window.ga('send','event','subscription','removed'),this._getSubscription().then(c=>{const e=c.toJSON(),f={name:e.endpoint};return c.unsubscribe(),this._keyHasChanged=!1,fetch(`${PushHandler.REMOTE_SERVER}/remove`,{headers:{"Content-Type":'application/json'},method:'POST',body:JSON.stringify(f)}).then(g=>{return idbKeyval.keys().then(l=>{return Promise.all(l.map(m=>idbKeyval.delete(m)))})}).then(g=>{console.log('Removed subscription.'),PushHandler.updateCurrentView(),PushControls.updateListing(),PushHandler._enableButtons('button[data-id]'),Toast.create('Unsubscribed successfully.',{tag:'all'}),this._waiting=!1}).catch(g=>{console.log('Failed to remove all.'),PushHandler.updateCurrentView(),PushControls.updateListing(),PushHandler._enableButtons('button[data-id]'),Toast.create('Unable to update.',{tag:'all'}),this._waiting=!1})})}static _getSubscription(){return navigator.serviceWorker.ready.then(c=>{return c.pushManager.getSubscription().then(e=>{return e&&!this._keyHasChanged?e:idbKeyval.set('appkey',this._keyString).then(f=>{return'function'==typeof window.ga&&window.ga('send','event','subscription','added'),c.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this._key}).catch(g=>{return console.log('Subscription rejected'),PushHandler._shutdown(),null})})})})}static updateSubscriptions(c){return this._waiting?Promise.resolve():(this._waiting=!0,this._getSubscription().then(e=>{const f=e.toJSON(),g={name:f.endpoint,subscription:f};return c.forEach(l=>{g[l.id]=l.subscribed}),fetch(`${PushHandler.REMOTE_SERVER}/subscribe`,{headers:{"Content-Type":'application/json'},method:'POST',body:JSON.stringify(g)}).then(l=>{return console.log('Subscriptions updated'),Promise.all(c.map(m=>idbKeyval.set(m.id,m.subscribed))).then(m=>{this._waiting=!1})})}))}}function installServiceWorker(){if(!('serviceWorker'in navigator))return void console.log('Service Worker not supported - aborting');var c=null;navigator.serviceWorker.onmessage=function(e){if('undefined'!=typeof e.data.version)if(null==c)c=e.data.version;else{var f=e.data.version,g=c.split('.'),l=f.split('.');g[0]===l[0]?console.log('Service Worker moved from '+c+' to '+f):Toast.create('Site updated. Refresh to get the latest!')}},navigator.serviceWorker.ready.then(function(e){'pushManager'in e&&PushHandler.init()}),navigator.serviceWorker.register('/devsummit/sw.js').then(function(e){e.active&&e.active.postMessage('version'),e.onupdatefound=function(){console.log('A new version has been found... Installing...'),e.installing.onstatechange=function(){return'installed'===this.state?console.log('App updated'):void('activated'===this.state&&e.active.postMessage('version'),console.log('Incoming SW state:',this.state))}}})}class VideoHandler{static get STATES(){return{STABLE:1,GOING_TO_BIG_PLAYER:2,GOING_TO_SMALL_PLAYER:3}}static get state(){return this._state||(this._state=VideoHandler.STATES.STABLE),this._state}static set state(c){this._state=c}static handle(c){var e=c&&c.getAttribute('data-youtube-id'),f=document.querySelector('iframe.youtube-video-player__thumb'),g=c&&c.querySelector('a');if(f){var l=f.parentNode;e&&window.location.href!==l.dataset.href?(console.log('Different video ('+e+'), embed the link.'),VideoHandler.embedLink(e,g)):VideoHandler._removeVideoPlayers(l.dataset.youtubeId)}else c?(console.log('Embed the link to the new video.'),VideoHandler.embedLink(e,g)):(console.log('Dismiss video because playingVideo = ',f),VideoHandler._removeVideoPlayers())}static toggleSmallPlayerIfNeeded(){var c=document.querySelector('iframe.youtube-video-player__thumb');if(c){var e=c.parentNode;window.location.href===e.dataset.href?(console.log('Already playing this video, remove small-player'),VideoHandler.disableSmallPlayer(e)):(console.log('Enabling small-player'),VideoHandler.enableSmallPlayer(e))}}static enableSmallPlayer(c){VideoHandler.state=VideoHandler.STATES.GOING_TO_SMALL_PLAYER;var e=c.getBoundingClientRect();c.classList.remove('youtube-video-player--small-player-animatable'),c.classList.add('youtube-video-player--small-player'),c.style.position='fixed',c.style.bottom='32px',c.style.right='32px',c.style.left='auto',c.style.top='auto',c.style.transform='scale(0.4)';var f=c.getBoundingClientRect(),g=e.right-f.right,l=e.bottom-f.bottom,m=e.width/f.width;c.style.transform='translate('+g+'px, '+l+'px) scale('+m+') scale(0.4)',requestAnimationFrame(function(){VideoHandler.state===VideoHandler.STATES.GOING_TO_BIG_PLAYER||requestAnimationFrame(function(){VideoHandler.state===VideoHandler.STATES.GOING_TO_BIG_PLAYER||(c.classList.add('youtube-video-player--small-player-animatable'),requestAnimationFrame(function(){VideoHandler.state===VideoHandler.STATES.GOING_TO_BIG_PLAYER||(c.style.transform='scale(0.4)',c.addEventListener('transitionend',VideoHandler._onTransitionEndToSmall))}))})})}static disableSmallPlayer(c){VideoHandler.state=VideoHandler.STATES.GOING_TO_BIG_PLAYER;var e=c.getBoundingClientRect();c.removeAttribute('style'),c.classList.remove('youtube-video-player--small-player'),c.classList.remove('youtube-video-player--small-player-animatable');var f=c.getBoundingClientRect(),g=window.getComputedStyle(c).transform,l=e.right-f.right,m=e.bottom-f.bottom,n=e.width/f.width;c.classList.add('youtube-video-player--small-player'),c.style.transform=g+'translate('+l+'px, '+m+'px) scale('+n+')',requestAnimationFrame(function(){VideoHandler.state===VideoHandler.STATES.GOING_TO_SMALL_PLAYER||requestAnimationFrame(function(){VideoHandler.state===VideoHandler.STATES.GOING_TO_SMALL_PLAYER||(c.classList.add('youtube-video-player--small-player-animatable'),requestAnimationFrame(function(){VideoHandler.state===VideoHandler.STATES.GOING_TO_SMALL_PLAYER||(c.removeAttribute('style'),c.addEventListener('transitionend',VideoHandler._onTransitionEndFromSmall))}))})})}static _onTransitionEndFromSmall(c){c.target.removeEventListener('transitionend',VideoHandler._onTransitionEndFromSmall),c.target.classList.remove('youtube-video-player--small-player'),c.target.classList.remove('youtube-video-player--small-player-animatable'),VideoHandler.state=VideoHandler.STATES.STABLE}static _onTransitionEndToSmall(c){c.target.removeEventListener('transitionend',VideoHandler._onTransitionEndToSmall),c.target.classList.remove('youtube-video-player--small-player-animatable'),VideoHandler.state=VideoHandler.STATES.STABLE}static _removeVideoPlayers(c){for(var e=document.querySelectorAll('.youtube-video-player'),f=0;f<e.length;f++)e[f].dataset.youtubeId!==c&&e[f].parentNode.removeChild(e[f])}static _getVideoPlayer(c){console.log('Getting video player for '+c);var e=document.querySelector('.masthead'),f=document.querySelector('.youtube-video-player[data-youtube-id="'+c+'"]');return f?f.innerHTML='':(f=document.createElement('div'),f.classList.add('youtube-video-player'),f.dataset.youtubeId=c,e.parentNode.insertBefore(f,e)),f}static embedLink(c,e){var f=VideoHandler._getVideoPlayer(c);return e?void f.appendChild(e):void console.warn('Expected link for ',c)}static beginPlayback(c){var e=/\?v=([^\/&]+)/.exec(c)[1],f=VideoHandler._getVideoPlayer(e),g=document.createElement('iframe'),l=document.createElement('a');g.classList.add('youtube-video-player__thumb'),g.src='https://www.youtube.com/embed/'+e+'?autoplay=1',g.setAttribute('frameborder','0'),g.setAttribute('allowfullscreen','true'),f.classList.add('youtube-video-player--opacity-locked'),f.appendChild(g),f.dataset.href=window.location.href,l.href=window.location.href,l.classList.add('youtube-video-player__link'),f.appendChild(l),VideoHandler._removeVideoPlayers(e)}}class SideNav{static init(){this.windowWidth=window.innerWidth;var c=document.querySelector('.menu'),e=c.querySelector('#menu__toggle');c.classList.add('menu--enhanced'),SideNav.checkInert(),e.addEventListener('change',function(){SideNav.checkInert()}),c.addEventListener('keydown',SideNav.trapTabKey),window.addEventListener('resize',function(){SideNav.windowWidth=window.innerWidth,SideNav.checkInert()})}static checkInert(){var c=document.querySelector('.menu'),e=c.querySelector('.menu__nav'),f=c.querySelector('#menu__toggle'),g=!f.checked&&424>SideNav.windowWidth;e.hasAttribute('inert')?e.inert=g:g&&e.setAttribute('inert',!0)}static trapTabKey(c){var e=document.querySelector('.menu'),f=e.querySelector('#menu__toggle'),g=e.querySelector('.menu__nav'),l=g.querySelector('.menu__nav div:last-of-type a');g.hasAttribute('inert')||(9===c.keyCode&&(c.shiftKey?document.activeElement===f&&(c.preventDefault(),l.focus()):document.activeElement===l&&(c.preventDefault(),f.focus())),27===c.keyCode&&(SideNav.close(),f.focus()))}static close(){document.querySelector('#menu__toggle').checked=!1}}class LiveSessionInfo{static toggle(){document.querySelector('.live-info')?this._enableUpdates():this._disableUpdates()}static _dateAsString(c){return`${c.getFullYear()}-${c.getMonth()+1}-${c.getDate()}`}static _timeAsString(c){return(10>c.getHours()?'0':'')+c.getHours().toString()+(10>c.getMinutes()?'0':'')+c.getMinutes().toString()}static _toPST(c){var e=new Date(c.getTime());return e.setTime(e.getTime()+60000*e.getTimezoneOffset()-28800000),e}static _getCurrentSessionIndex(c){for(var f,g,e=null,l=LiveSessionInfo._toPST(new Date),m=new Date,n=this._dateAsString(l),o=0;o<c.length;o++)if(g=LiveSessionInfo._toPST(c[o]),f=this._dateAsString(g),f===n)if(c[o].getTime()<m.getTime())e=o;else break;return e}static _getNextSessionIndex(c,e){var f=e+1,g=LiveSessionInfo._toPST(new Date);if(null===e&&0<c.length){for(var m,l=new Date,n=this._dateAsString(l),o=0;o<c.length;o++)if((m=this._dateAsString(c[o]),m===n)&&c[o].getTime()>l.getTime())return o;return 0}if(f>=c.length)return null;var q=LiveSessionInfo._toPST(c[f]);return this._dateAsString(g)===this._dateAsString(q)?f:null}static _getNextSessionSwitchTime(c){for(var e=new Date().getTime(),f=0;f<c.length;f++)if(c[f].getTime()>e)return c[f].getTime()-e;return null}static refresh(){if(this._sessions){var c=[];0===c.length&&(c=SessionLoader.toArray(this._sessions));var e=this._getCurrentSessionIndex(c),f=this._getNextSessionIndex(c,e),g=c[e],l=this._sessions.get(g);this._setCurrentSessionInfo(l);var m=c[f],n=this._sessions.get(m);this._setNextSessionInfo(m,n),this._populateRemainingDayItems(c);var o=this._getNextSessionSwitchTime(c);if(null!==o){o+=1000;var q=Math.round(o/1000);console.log('Refreshing listing in '+(q/60).toFixed(2)+' mins'),clearTimeout(this._refreshTimeoutIndex),this._refreshTimeoutIndex=setTimeout(this.refresh.bind(this),o)}}}static _enableUpdates(){SessionLoader.getData().then(function(c){this._sessions=c,this.refresh()}.bind(this))}static _setCurrentSessionInfo(c){var e=document.querySelector('.js-live-info-current');return e?c?void(e.removeAttribute('aria-hidden'),e.querySelector('.live-info__section').textContent='Live Now',e.querySelector('.live-info__title').textContent=(c.speaker?c.speaker+': ':'')+c.name,e.querySelector('.live-info__description').textContent=c.description):(e.querySelector('.live-info__section').textContent='',e.querySelector('.live-info__title').textContent='',e.querySelector('.live-info__description').textContent='',void e.setAttribute('aria-hidden','true')):void 0}static _setNextSessionInfo(c,e){var f=document.querySelector('.js-live-info-next');return f?e?void(f.removeAttribute('aria-hidden'),f.querySelector('.live-info__section').textContent='Up Next...',f.querySelector('.live-info__title').textContent=(e.speaker?e.speaker+': ':'')+e.name,f.querySelector('.live-info__description').textContent=e.description,idbKeyval.get('localized-times').then(function(g){var l=new Date(c.getTime());g||l.setTime(l.getTime()+60000*l.getTimezoneOffset()-28800000),f.querySelector('.live-info__time').textContent=LiveSessionInfo._timeAsString(l)})):(f.querySelector('.live-info__section').textContent='',f.querySelector('.live-info__title').textContent='',f.querySelector('.live-info__time').textContent='',f.querySelector('.live-info__description').textContent='',void f.setAttribute('aria-hidden','true')):void 0}static _disableUpdates(){clearTimeout(this._refreshTimeoutIndex)}static _populateRemainingDayItems(c){var e=document.querySelector('.live-coming-up');e&&idbKeyval.get('localized-times').then(function(f){for(var n,o,q,g=document.querySelector('.live-coming-up__list'),l=Date.now(),m=new Date,u=[],w=!0,z=LiveSessionInfo._toPST(new Date),A=0;A<c.length;A++)if(n=c[A],!(n.getTime()<l)){if(w){w=!1;continue}var B=LiveSessionInfo._toPST(n);if(LiveSessionInfo._dateAsString(B)===LiveSessionInfo._dateAsString(z)){var C=new Date(n.getTime());f||C.setTime(C.getTime()-60000*(480-m.getTimezoneOffset())),q=LiveSessionInfo._sessions.get(n),o=LiveSessionInfo._timeAsString(C),u.push(`<li class="live-coming-up__item">
            <time class="live-coming-up__item-time"
                  datetime="${n.toISOString()}">
              ${o}
            </time>
            <a class="live-coming-up__item-description">
              <h3 class="live-coming-up__item-title">
                ${q.name}
              </h3>
              ${q.speaker?`<p class="live-coming-up__item-author">${q.speaker}</p>`:''}
            </a>
          </li>`)}}return 0===u.length?(g.innerHTML='',e.classList.add('live-coming-up--empty'),void e.setAttribute('aria-hidden',!0)):void(e.classList.remove('live-coming-up--empty'),e.removeAttribute('aria-hidden'),g.innerHTML=u.join(''))})}}class LiveBanner{static toggle(){var c=Date.now(),e=Date.parse('2016-11-10T07:30:00-08:00'),f=Date.parse('2016-11-11T18:00:00-08:00'),g=c>e&&c<f&&'/devsummit/'!==window.location.pathname,l=document.querySelector('.masthead'),m=document.querySelector('.header'),n=document.querySelector('.header__live-stream');g?(l.classList.add('masthead--live'),m.classList.add('header--live'),n.classList.add('visible'),n.removeAttribute('aria-hidden')):(l.classList.remove('masthead--live'),m.classList.remove('header--live'),n.classList.remove('visible'),n.setAttribute('aria-hidden',!0))}}var _vrButton=document.createElement('button');class VR{static init(){_vrButton.setAttribute('aria-label','See venue in WebVR'),_vrButton.classList.add('vr'),_vrButton.addEventListener('click',VR._onClick.bind(VR)),VR.toggleButton()}static toggleButton(){if('/devsummit/location'!==window.location.pathname)return Promise.resolve();var c=document.querySelector('.masthead');return new Promise(function(e){_vrButton.classList.add('hide'),c.appendChild(_vrButton),requestAnimationFrame(function(){requestAnimationFrame(function(){_vrButton.classList.remove('hide'),_vrButton.addEventListener('transitionend',function f(){_vrButton.removeEventListener('transitionend',f),e()})})})})}static hideButton(){Promise.resolve(),_vrButton.parentNode&&new Promise(function(e){_vrButton.classList.add('hide'),_vrButton.addEventListener('transitionend',function f(){_vrButton.removeEventListener('transitionend',f),e()})}).then(function(){_vrButton.parentNode.removeChild(_vrButton)});var c=document.querySelector('.masthead');c.addEventListener('transitionend',function e(){c.removeEventListener('transitionend',e);var f=c.querySelector('.masthead__vr');f&&f.parentNode.removeChild(f)})}static _onClick(c){VR.hideButton(),loadScript('{{ "/devsummit/static/scripts/webvr.js" | add_hash }}',!0)}}var initialized=!1;function init(){initialized||(initialized=!0,SideNav.init(),VR.init(),LiveSessionInfo.toggle(),LiveBanner.toggle(),new class{constructor(){this._location=window.location.pathname,this._isSwapping=!1,this._request=null,this._spinnerTimeout=0,this._onChanged=this._onChanged.bind(this),this._onLoad=this._onLoad.bind(this),this._onClick=this._onClick.bind(this),this._onSwapComplete=this._onSwapComplete.bind(this),this._newContent=null,this._masthead=document.querySelector('.masthead'),this._mastheadTitle=document.querySelector('.masthead__title'),this._mastheadGraphic=document.querySelector('.masthead__graphic'),this._mastheadDivider=document.querySelector('.masthead-underlay__divider'),this._pageContent=document.querySelector('.page-content'),this._liveBanner=document.querySelector('.header__live-stream'),this._videoPlayer=document.querySelector('.youtube-video-player'),this.addEventListeners(),document.body.classList.add('animatable'),this._onChanged(),this._updateTimes()}_onLoad(e){e.target!==this._request||(this._newContent=e.target.response)}_onChanged(e){window.location.pathname===this._location||(this._location=window.location.pathname,VideoHandler.toggleSmallPlayerIfNeeded(),this._updateNavLinks(),this._showSpinner(),'function'==typeof window.ga&&window.ga('send','pageview'),Promise.all([this._hideAreas(),this._loadNewPath(),VR.hideButton()]).then(function(){this._isSwapping||(this._isSwapping=!0,this._hideSpinner(),this._swapContents())}.bind(this)).then(f=>{VR.toggleButton(),e&&e.state&&window.scrollTo(0,e.state.scrollY)}))}_showSpinner(){this._spinnerTimeout=setTimeout(function(){this._masthead.classList.add('masthead--spinner')}.bind(this),1000)}_hideSpinner(){clearTimeout(this._spinnerTimeout),this._masthead.classList.remove('masthead--spinner')}_loadNewPath(){return new Promise(function(e,f){var g=window.location.pathname+window.location.search;this._request=new XMLHttpRequest,this._request.responseType='document',this._request.onload=function(l){this._onLoad(l),e()}.bind(this),this._request.onerror=f,this._request.open('get',g),this._request.send()}.bind(this))}_updateNavLinks(){for(var f,g,e=document.querySelectorAll('nav a'),l=0;l<e.length;l++)g=e[l],f=new URL(g.href).href,g.parentNode.classList.remove('menu__nav-item--active'),f===window.location.href&&g.parentNode.classList.add('menu__nav-item--active')}_hideAreas(){return new Promise(function(e,f){return document.body.classList.contains('hide-areas')?void e():void(this._mastheadGraphic.addEventListener('transitionend',e),document.body.classList.add('hide-areas'))}.bind(this))}_swapContents(){var e=this._newContent.querySelector('.masthead__title'),f=this._newContent.querySelector('.masthead'),g=this._newContent.querySelector('.masthead__graphic'),l=this._newContent.querySelector('.masthead-underlay__divider'),m=this._newContent.querySelector('.page-content'),n=this._newContent.querySelector('style[id^="styles"]'),o=this._newContent.querySelector('.header__live-stream'),q=this._newContent.querySelector('.youtube-video-player');this._mastheadGraphic.removeEventListener('transitionend',this._onTransitionEnd),e?(this._mastheadTitle.innerHTML=e.innerHTML,this._mastheadTitle.removeAttribute('aria-hidden'),this._mastheadTitle.focus()):(this._mastheadTitle.innerHTML='',this._mastheadTitle.setAttribute('aria-hidden','true'),this._pageContent.focus()),document.querySelector('#'+n.id)||document.head.appendChild(n.cloneNode(!0)),VideoHandler.handle(q),this._mastheadGraphic.innerHTML=g.innerHTML,this._pageContent.innerHTML=m.innerHTML,this._pageContent.className=m.className,this._masthead.className=f.className,this._liveBanner.className=o.className,l.classList.contains('masthead-underlay__divider--invisible')?this._mastheadDivider.classList.add('masthead-underlay__divider--invisible'):this._mastheadDivider.classList.remove('masthead-underlay__divider--invisible'),PushHandler.updateCurrentView(),this._updateTimes(),requestAnimationFrame(function(){requestAnimationFrame(function(){document.body.classList.remove('hide-areas'),requestAnimationFrame(this._onSwapComplete)}.bind(this))}.bind(this))}_onSwapComplete(){this._isSwapping=!1,LiveSessionInfo.toggle(),LiveBanner.toggle()}_toggleLocalizedTimes(){var e=this;return idbKeyval.get('localized-times').then(function(f){var g=!(!!f).valueOf();return idbKeyval.set('localized-times',g).then(function(){LiveSessionInfo.refresh(),e._updateTimes()})})}_updateAdjustmentControl(e){var f=document.querySelector('.schedule-adjustment');if(f){var g=document.querySelector('.toggle-localized-times'),l=new Date(2016,10,10,6,0,0),m=-l.getTimezoneOffset()/60,n=new Intl.DateTimeFormat('en-us',{year:'numeric',timeZoneName:'short'}),o=f.querySelector('.schedule-adjustment__value');if(-8==m)f.classList.remove('schedule-adjustment--visible'),f.setAttribute('aria-hidden','true');else{var q=n.format(l).split(' ');if(2>q.length)return;f.classList.add('schedule-adjustment--visible'),f.removeAttribute('aria-hidden'),o.textContent=e?q[1]:'PST',g&&(g.textContent='Adjust to '+(e?'PST':q[1]))}}}_updateTimeElements(e){for(var l,m,n,f=new Date(2016,10,10,6,0,0),g=document.querySelectorAll('time'),o=0;o<g.length;o++){if(n=g[o].getAttribute('datetime'),!n)return;l=new Date(n),e||l.setTime(l.getTime()-60000*(480-f.getTimezoneOffset())),m=(10>l.getHours()?'0':'')+l.getHours()+(10>l.getMinutes()?'0':'')+l.getMinutes(),g[o].textContent=m}}_updateTimes(){var e=this;idbKeyval.get('localized-times').then(function(f){e._updateAdjustmentControl(f),e._updateTimeElements(f)})}go(e){if(window.location.href!==e){var f={scrollY:window.scrollY};return window.history.replaceState(f,null,window.location.href),window.history.pushState(null,null,e),this._onChanged()}}_onClick(e){if(!(e.metaKey||e.ctrlKey||0!==e.button)){if(e.target.classList.contains('toggle-localized-times'))return void this._toggleLocalizedTimes();var f=e.target;do{if(null===f||'a'===f.nodeName.toLowerCase())break;f=f.parentNode}while(f);if(f){var g=/devsummit/.test(f.href),l=/youtube\.com\/watch/.test(f.href);g?(e.preventDefault(),this.go(f.href),SideNav.close()):l&&(e.preventDefault(),VideoHandler.beginPlayback(f.href))}e.target.classList.contains('js-notification-btn')&&(e.preventDefault(),PushHandler.processChange(e))}}addEventListeners(){document.addEventListener('click',this._onClick),window.addEventListener('popstate',this._onChanged)}})}function loadPageStyles(){document.querySelector('link[href="{{ "/devsummit/static/styles/cds.css" | add_hash }}"]')||loadStyles('{{ "/devsummit/static/styles/cds.css" | add_hash }}')}(function(){loadPageStyles(),installServiceWorker(),init(),window.addEventListener('load',function(){loadScript('//www.googleadservices.com/pagead/conversion_async.js',!0)}),loadScript('{{ "/devsummit/static/third_party/scripts/inert.min.js" | add_hash }}',!1)})();
